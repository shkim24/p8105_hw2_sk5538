HW2
================
Senna
2024-09-30

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(readxl)
```

Read and clean the data; retain line, station, name, station latitude /
longitude, routes served, entry, vending, entrance type, and ADA
compliance. Convert the entry variable from character (YES vs NO) to a
logical variable (the ifelse or case_match function may be useful).

read and clean data

``` r
mta_df = read_csv(file ="./data/NYC_Transit_Subway_Entrance_And_Exit_data.csv")|>
  janitor::clean_names()
```

    ## Rows: 1868 Columns: 32
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (22): Division, Line, Station Name, Route1, Route2, Route3, Route4, Rout...
    ## dbl  (8): Station Latitude, Station Longitude, Route8, Route9, Route10, Rout...
    ## lgl  (2): ADA, Free Crossover
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

select relevant columns, mutate entry variable

``` r
mta_clean= mta_df |>
  select(line, station_name, station_latitude, station_longitude, starts_with("route"), entry, vending, entrance_type, ada) |>
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
```

Write a short paragraph about this dataset – explain briefly what
variables the dataset contains, describe your data cleaning steps so
far, and give the dimension (rows x columns) of the resulting dataset.
Are these data tidy?

``` r
names(mta_clean)
```

    ##  [1] "line"              "station_name"      "station_latitude" 
    ##  [4] "station_longitude" "route1"            "route2"           
    ##  [7] "route3"            "route4"            "route5"           
    ## [10] "route6"            "route7"            "route8"           
    ## [13] "route9"            "route10"           "route11"          
    ## [16] "entry"             "vending"           "entrance_type"    
    ## [19] "ada"

``` r
str(mta_clean)
```

    ## tibble [1,868 × 19] (S3: tbl_df/tbl/data.frame)
    ##  $ line             : chr [1:1868] "4 Avenue" "4 Avenue" "4 Avenue" "4 Avenue" ...
    ##  $ station_name     : chr [1:1868] "25th St" "25th St" "36th St" "36th St" ...
    ##  $ station_latitude : num [1:1868] 40.7 40.7 40.7 40.7 40.7 ...
    ##  $ station_longitude: num [1:1868] -74 -74 -74 -74 -74 ...
    ##  $ route1           : chr [1:1868] "R" "R" "N" "N" ...
    ##  $ route2           : chr [1:1868] NA NA "R" "R" ...
    ##  $ route3           : chr [1:1868] NA NA NA NA ...
    ##  $ route4           : chr [1:1868] NA NA NA NA ...
    ##  $ route5           : chr [1:1868] NA NA NA NA ...
    ##  $ route6           : chr [1:1868] NA NA NA NA ...
    ##  $ route7           : chr [1:1868] NA NA NA NA ...
    ##  $ route8           : num [1:1868] NA NA NA NA NA NA NA NA NA NA ...
    ##  $ route9           : num [1:1868] NA NA NA NA NA NA NA NA NA NA ...
    ##  $ route10          : num [1:1868] NA NA NA NA NA NA NA NA NA NA ...
    ##  $ route11          : num [1:1868] NA NA NA NA NA NA NA NA NA NA ...
    ##  $ entry            : logi [1:1868] TRUE TRUE TRUE TRUE TRUE TRUE ...
    ##  $ vending          : chr [1:1868] "YES" "YES" "YES" "YES" ...
    ##  $ entrance_type    : chr [1:1868] "Stair" "Stair" "Stair" "Stair" ...
    ##  $ ada              : logi [1:1868] FALSE FALSE FALSE FALSE FALSE FALSE ...

``` r
dim(mta_clean)
```

    ## [1] 1868   19

Answer the following questions using these data:

How many distinct stations are there? Note that stations are identified
both by name and by line (e.g. 125th St 8th Avenue; 125st Broadway;
125st Lenox); the distinct function may be useful here.

``` r
distinct_station = distinct(mta_clean, line, station_name)
nrow(distinct_station)
```

    ## [1] 465

How many stations are ADA compliant?

``` r
ada_stations = mta_clean |>
  filter(ada == TRUE) |>
  distinct (station_name, line)

nrow(ada_stations)
```

    ## [1] 84

What proportion of station entrances / exits without vending allow
entrance?

``` r
no_vending_entrances <- mta_clean |>
  filter(vending == "NO") |>
  summarise(proportion = mean(entry))
no_vending_entrances
```

    ## # A tibble: 1 × 1
    ##   proportion
    ##        <dbl>
    ## 1      0.377

Reformat data so that route number and route name are distinct
variables. How many distinct stations serve the A train? Of the stations
that serve the A train, how many are ADA compliant?

``` r
mta_tidy <- mta_clean |>
  mutate(across(route1:route11, as.character)) |>
  pivot_longer(
    cols = route1:route11,
    names_to = 'route',
    values_to = 'route_value'
  ) |>
  mutate(
    route_name = ifelse(is.na(suppressWarnings(as.numeric(route_value))), route_value, NA),
    route_number = ifelse(!is.na(suppressWarnings(as.numeric(route_value))), as.numeric(route_value), NA)
  ) |>
  select(-route_value) 
```

    ## Warning: There was 1 warning in `mutate()`.
    ## ℹ In argument: `route_number = ifelse(...)`.
    ## Caused by warning in `ifelse()`:
    ## ! NAs introduced by coercion

``` r
A_train = mta_tidy |>
  filter (route_name =="A")

nrow(distinct(A_train, station_name, line))
```

    ## [1] 60

``` r
ada_A_train = A_train|>
  filter(ada == TRUE)

nrow(distinct(ada_A_train, station_name, line))
```

    ## [1] 17

Problem 2

This problem uses the Mr. Trash Wheel dataset, available as an Excel
file on the course website.

Read and clean the Mr. Trash Wheel sheet: specify the sheet in the Excel
file and to omit non-data entries (rows with notes / figures; columns
containing notes) using arguments in read_excel use reasonable variable
names

``` r
trashwheel_df= read_excel("./data/202309 Trash Wheel Collection Data.xlsx",
                          sheet=1, 
                          skip=1, 
                          na = c(".", "NA", ""),
                          )
```

    ## New names:
    ## • `` -> `...15`
    ## • `` -> `...16`

``` r
trashwheel_df = janitor::clean_names(trashwheel_df)

names(trashwheel_df)
```

    ##  [1] "dumpster"           "month"              "year"              
    ##  [4] "date"               "weight_tons"        "volume_cubic_yards"
    ##  [7] "plastic_bottles"    "polystyrene"        "cigarette_butts"   
    ## [10] "glass_bottles"      "plastic_bags"       "wrappers"          
    ## [13] "sports_balls"       "homes_powered"      "x15"               
    ## [16] "x16"

``` r
trashwheel_df = select(trashwheel_df, -x15, -x16)
```

omit rows that do not include dumpster-specific data round the number of
sports balls to the nearest integer and converts the result to an
integer variable (using as.integer)

``` r
trashwheel_df = trashwheel_df[!is.na(trashwheel_df[, "dumpster"]), ]

trashwheel_df[['sports_balls']] <- as.integer(round(trashwheel_df[['sports_balls']]))

view(trashwheel_df)
```

Use a similar process to import, clean, and organize the data for
Professor Trash Wheel and Gwynnda, and combine this with the Mr. Trash
Wheel dataset to produce a single tidy dataset. To keep track of which
Trash Wheel is which, you may need to add an additional variable to both
datasets before combining.

Write a paragraph about these data; you are encouraged to use inline R.
Be sure to note the number of observations in the resulting dataset, and
give examples of key variables. For available data, what was the total
weight of trash collected by Professor Trash Wheel? What was the total
number of cigarette butts collected by Gwynnda in June of 2022?

Problem 3

your goal is to create a single, well-organized dataset with all the
information contained in these data files. To that end: import, clean,
tidy, and otherwise wrangle each of these datasets;

``` r
bakers = read_csv(file = './data/gbb_datasets/bakers.csv') |>
  janitor::clean_names()
```

    ## Rows: 120 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (3): Baker Name, Baker Occupation, Hometown
    ## dbl (2): Series, Baker Age
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
bakes = read_csv(file = './data/gbb_datasets/bakes.csv', na = "N/A")|>
  janitor::clean_names()
```

    ## Rows: 548 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (3): Baker, Signature Bake, Show Stopper
    ## dbl (2): Series, Episode
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
results = read_csv(file = './data/gbb_datasets/results.csv', skip=2)|>
  janitor::clean_names()
```

    ## Rows: 1136 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (2): baker, result
    ## dbl (3): series, episode, technical
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

check for completeness and correctness across datasets (e.g. by viewing
individual datasets and using anti_join);

``` r
anti_join(results, bakes, by = 'baker')
```

    ## # A tibble: 228 × 5
    ##    series episode baker  technical result    
    ##     <dbl>   <dbl> <chr>      <dbl> <chr>     
    ##  1      2       1 Joanne        11 IN        
    ##  2      2       2 Joanne        10 IN        
    ##  3      2       3 Joanne         1 IN        
    ##  4      2       4 Joanne         8 IN        
    ##  5      2       5 Joanne         6 IN        
    ##  6      2       6 Joanne         1 STAR BAKER
    ##  7      2       7 Joanne         3 IN        
    ##  8      2       8 Joanne         1 WINNER    
    ##  9      9       1 Antony        12 IN        
    ## 10      9       1 Briony         2 IN        
    ## # ℹ 218 more rows

merge to create a single, final dataset;

and organize this so that variables and observations are in meaningful
orders.

Export the result as a CSV in the directory containing the original
datasets.
